<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>


    <script src="https://code.jquery.com/jquery-3.1.1.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="./weather.css">

    <script type="text/javascript">


      //77개
      var locations = {
        '대구':{
         "elocal":'daegu',
         "lon":128.35,
         "lat":35.52
       },
        '대전':{
         "elocal":'daejeon',
         "lon":127.26,
         "lat":36.20
       },
      //  '목포':{
      //    "elocal":'mokpo',
      //    "lon":126.22,
      //    "lat":34.48
      //  },
      //  '광주':{
      //    "elocal":'gwangju',
      //    "lon":125.54,
      //    "lat":35.09
      //  },
      //  '강릉':{
      //    "elocal":'gangneung',
      //    "lon":128.54,
      //    "lat":37.45
      //  },
      //  '서울':{
      //    "elocal":'seoul',
      //    "lon":127.00,
      //    "lat":37.30
      //  },
      //  '수원':{
      //    "elocal":'suwon',
      //    "lon":127.01,
      //    "lat":37.17
      //  },
      //  '안동':{
      //    "elocal":'andong',
      //    "lon":128.44,
      //    "lat":36.35
      //  },
      //  '제주':{
      //    "elocal":'jeju',
      //    "lon":126.32,
      //    "lat":33.31
      //  },
      //  '청주':{
      //    "elocal":'cheongju',
      //    "lon":125.13,
      //    "lat":39.41
      //  },
      //  '인천':{
      //    "elocal":'incheon',
      //    "lon":126.38,
      //    "lat":37.28
      //  },
      //  '전주':{
      //    "elocal":'jeonju',
      //    "lon":127.08,
      //    "lat":35.49
      //  },
      //  '부산':{
      //    "elocal":'busan',
      //    "lon":129.03,
      //    "lat":35.06
      //  },
      //  '춘천':{
      //    "elocal":'chuncheon',
      //    "lon":127.53,
      //    "lat":37.52
      //  },
      //  '서산':{
      //    "elocal":'seosan',
      //    "lon":126.45,
      //    "lat":36.78
      //  },
      //  '포항':{
      //    "elocal":'pohang',
      //    "lon":129.36,
      //    "lat":36.02
      //  },
      //  '울산':{
      //    "elocal":'ulsan',
      //    "lon":129.27,
      //    "lat":35.54
      //  },
      //  '여수':{
      //    "elocal":'yeosu',
      //    "lon":127.66,
      //    "lat":34.76
      //  },
      //  '창원':{
      //    "elocal":'changwon',
      //    "lon":127.62,
      //    "lat":35.18
      //  },
      //  '울릉':{
      //    "elocal":'ulleung',
      //    "lon":130.85,
      //    "lat":37.50
      //  },



      //   '마산시':{
      //    "lon":128.32,
      //    "lat":35.11
      //  },
      //   '예천군':{
      //    "lon":128.26,
      //    "lat":36.40
      //  },
      //   '옥천군':{
      //    "lon":127.34,
      //    "lat":36.20
      //  },
      //   '완도군':{
      //    "lon":126.47,
      //    "lat":34.18
      //  },
      //   '원산':{
      //    "lon":127.25,
      //    "lat":39.09
      //  },
      //   '원주':{
      //    "lon":127.58,
      //    "lat":37.22
      //  },
      //   '광양시':{
      //    "lon":127.34,
      //    "lat":34.59
      //  },
      //   '김제시':{
      //    "lon":128.52,
      //    "lat":35.38
      //  },
      //   '김책':{
      //    "lon":129.12,
      //    "lat":40.41
      //  },
      //   '김천시':{
      //    "lon":128.05,
      //    "lat":36.07
      //  },
      //   '김해시':{
      //    "lon":128.52,
      //    "lat":35.14
      //  },
      //   '군산시':{
      //    "lon":126.41,
      //    "lat":35.58
      //  },
      //   '군위군':{
      //    "lon":128.34,
      //    "lat":36.15
      //  },
      //   '금산군':{
      //    "lon":127.30,
      //    "lat":36.07
      //  },
      //   '사리원':{
      //    "lon":124.24,
      //    "lat":40.05
      //  },
      //   '삼척시':{
      //    "lon":129.10,
      //    "lat":37.27
      //  },
      //   '상주시':{
      //    "lon":128.09,
      //    "lat":36.26
      //  },
      //   '강계':{
      //    "lon":126.34,
      //    "lat":40.58
      //  },
      //   '개성':{
      //    "lon":126.33,
      //    "lat":37.59
      //  },
      //   '경산시':{
      //    "lon":128.43,
      //    "lat":35.48
      //  },
      //   '강진군':{
      //    "lon":126.45,
      //    "lat":34.39
      //  },
      //   '강화도':{
      //    "lon":126.30,
      //    "lat":37.45
      //  },
      //   '고령군':{
      //    "lon":129.14,
      //    "lat":35.51
      //  },
      //   '고성':{
      //    "lon":125.23,
      //    "lat":38.45
      //  },
      //   '고흥군':{
      //    "lon":127.16,
      //    "lat":34.17
      //  },
      //   '공주시':{
      //    "lon":127.07,
      //    "lat":36.27
      //  },
      //   '순천':{
      //    "lon":125.54,
      //    "lat":39.26
      //  },
      //   '순천시':{
      //    "lon":127.28,
      //    "lat":34.57
      //  },
      //   '속초시':{
      //    "lon":128.36,
      //    "lat":38.12
      //  },
      //   '송림':{
      //    "lon":125.38,
      //    "lat":38.44
      //  },
      //   '신안군':{
      //    "lon":125.36,
      //    "lat":39.36
      //  },
      //   '양구군':{
      //    "lon":127.59,
      //    "lat":38.06
      //  },
      //   '양산시':{
      //    "lon":129.03,
      //    "lat":35.21
      //  },
      //   '양양군':{
      //    "lon":128.36,
      //    "lat":38.04
      //  },
      //   '양평군':{
      //    "lon":127.29,
      //    "lat":37.30
      //  },
      //   '안양시':{
      //    "lon":126.55,
      //    "lat":37.23
      //  },
      //   '무주군':{
      //    "lon":127.40,
      //    "lat":36.02
      //  },
      //   '남원시':{
      //    "lon":127.21,
      //    "lat":35.25
      //  },
      //   '남양주시':{
      //    "lon":126.44,
      //    "lat":37.14
      //  },
      //   '남해군':{
      //    "lon":127.54,
      //    "lat":34.50
      //  },
      //   '나주시':{
      //    "lon":126.43,
      //    "lat":35.03
      //  },
      //   '논산시':{
      //    "lon":127.05,
      //    "lat":36.12
      //  },
      //   '청양군':{
      //    "lon":128.03,
      //    "lat":41.11
      //  },
      //   '창녕군':{
      //    "lon":125.16,
      //    "lat":38.37
      //  },
      //   '충주시':{
      //    "lon":127.08,
      //    "lat":35.49
      //  },
      //   '의성군':{
      //    "lon":128.41,
      //    "lat":36.22
      //  },
      //   '의정부시':{
      //    "lon":127.03,
      //    "lat":37.44
      //  },
      //   '판문점':{
      //    "lon":125.41,
      //    "lat":39.02
      //  },
      //   '평창군':{
      //    "lon":129.03,
      //    "lat":35.06
      //  },
      //   '인제군':{
      //    "lon":128.09,
      //    "lat":38.05
      //  },
      //   '진주시':{
      //    "lon":128.05,
      //    "lat":35.11
      //  },
      //   '진해시':{
      //    "lon":128.40,
      //    "lat":35.09
      //  },
      //   '하동군':{
      //    "lon":127.44,
      //    "lat":35.05
      //  },
      //   '하남시':{
      //    "lon":126.43,
      //    "lat":38.23
      //  },
      //   '함양군':{
      //    "lon":127.42,
      //    "lat":35.32
      //  },
      //   '함안군':{
      //    "lon":128.24,
      //    "lat":35.15
      //  },
      //   '해남군':{
      //    "lon":126.35,
      //    "lat":34.34
      //  },
      //   '함평군':{
      //    "lon":126.30,
      //    "lat":35.05
      //  },
      //   '해주':{
      //    "lon":125.42,
      //    "lat":38.02
      //  },
      //   '함흥':{
      //    "lon":127.32,
      //    "lat":39.54
      //  },
      //   '혜산':{
      //    "lon":128.12,
      //    "lat":41.23
      //  },
      //   '홍성군':{
      //    "lon":126.29,
      //    "lat":36.36
      //  },
      //   '홍천군':{
      //    "lon":127.52,
      //    "lat":37.42
      //  },


      }

      // location end

      var cloud_status = {
        'SKY_W00':{
          'weather':'상태없음',
          'icon':38,
        },
        'SKY_W01':{
          'weather':'맑음',
          'icon':1,
        },
        'SKY_W02':{
          'weather':'구름조금',
          'icon':2,
        },
        'SKY_W03':{
          'weather':'구름많음',
          'icon':3,
        },
        'SKY_W04':{
          'weather':'흐림',
          'icon':18,
        },
        'SKY_W07':{
          'weather':'흐리고 비',
          'icon':21,
        },
        'SKY_W09':{
          'weather':'구름많고 비',
          'icon':12,
        },
        'SKY_W10':{
          'weather':'소나기',
          'icon':21,
        },
        'SKY_W11':{
          'weather':'비 또는 눈',
          'icon':4,
        },
        'SKY_W12':{
          'weather':'구름많고 눈',
          'icon':13,
        },
        'SKY_W13':{
          'weather':'흐리고 눈',
          'icon':32,
        }
      }

      // var cloud_status = {
      //   '200' : 'thunderstorm with light rain',
      //   '201'	: 'thunderstorm with rain',
      //   '202'	: 'thunderstorm with heavy rain',
      //   '210'	: 'light thunderstorm',
      //   '212'	: 'heavy thunderstorm',
      //   '211'	: 'thunderstorm',
      //   '221'	: 'ragged thunderstorm',
      //   '230'	: 'thunderstorm with light drizzle',
      //   '231'	: 'thunderstorm with drizzle',
      //   '232'	: 'thunderstorm with heavy drizzle',
      //
      //   '300'	: 'light intensity drizzle',
      //   '301'	: 'Drizzle',
      //   '302'	: 'heavy intensity drizzle',
      //   '310'	: 'light intensity drizzle rain',
      //   '311'	: 'drizzle rain',
      //   '312'	: 'heavy intensity drizzle rain',
      //   '313'	: 'shower rain and drizzle',
      //   '314'	: 'heavy shower rain and drizzle',
      //   '321'	: 'shower drizzle',
      //
      //   '500'	: 'light rain',
      //   '501'	: 'moderate rain',
      //   '502'	: 'heavy intensity rain',
      //   '503'	: 'very heavy rain',
      //   '504'	: 'extreme rain',
      //   '511'	: 'freezing rain',
      //   '520'	: 'light intensity shower rain',
      //   '521'	: 'shower rain',
      //   '522'	: 'heavy intensity shower rain',
      //   '531'	: 'ragged shower rain',
      //
      //   '600'	: 'light snow',
      //   '601'	: 'Snow',
      //   '602'	: 'heavy snow',
      //   '611'	: 'Sleet',
      //   '612'	: 'shower sleet',
      //   '615'	: 'light rain and snow',
      //   '616'	: 'rain and snow',
      //   '620'	: 'light shower snow',
      //   '621'	: 'shower snow',
      //   '622'	: 'heavy shower snow',
      //
      //   '701'	: 'Mist',
      //   '711'	: 'Smoke',
      //   '721'	: 'Haze',
      //   '731'	: 'Sand/Dust Whirls',
      //   '741'	: 'Fog',
      //   '751'	: 'Sand',
      //   '761'	: 'Dust',
      //   '762'	: 'VOLCANIC ASH',
      //   '771'	: 'SQUALLS',
      //   '781'	: 'TORNADO',
      //
      //   '800'	: 'sky is clear',
      //   '801'	: 'few clouds',
      //   '802'	: 'scattered clouds',
      //   '803'	: 'broken clouds',
      //   '804'	: 'overcast clouds',
      //
      //   '900'	: 'Tornado',
      //   '901'	: 'tropical storm',
      //   '902'	: 'Hurricane',
      //   '903'	: 'Cold',
      //   '904'	: 'Hot',
      //   '905'	: 'Windy',
      //   '906'	: 'Hail',
      //   '950'	: 'Setting',
      //   '951'	: 'Calm',
      //   '952'	: 'Light breeze',
      //   '953'	: 'Gentle Breeze',
      //   '954'	: 'Moderate breeze',
      //   '955'	: 'Fresh Breeze',
      //   '956'	: 'Strong breeze',
      //   '957'	: 'High wind, near gale',
      //   '958'	: 'Gale',
      //   '959'	: 'Severe Gale',
      //   '960'	: 'Storm',
      //   '961'	: 'Violent Storm',
      //   '962' :'Hurricane',
      // }

      var weathers = [];


      function getWorldWeather(){


        for(var location_name in locations){

          $.ajax({

            type: 'GET' ,
            headers : {
              "appKey" : "06110e9f-0792-32ee-9cb9-6b1bba593ab6",
            },
            url: 'http://apis.skplanetx.com/gweather/forecast/mid?timezone=KST&lon='+ locations[location_name].lon  +'&lat='+ locations[location_name].lat +'&units=&version=1' ,
            // url: 'http://apis.skplanetx.com/gweather/forecast/mid?timezone=KST&lon='+ 129.03  +'&lat='+ 35.06 +'&units=&version=1' ,
            dataType : 'json' ,
            success: function(data) {
              var local_weather = [];

              // console.log(data);
              // var local = data['gweather']['forecastDays'][0]['location']['city'];
              var local = location_name;
              var sunrise = data['gweather']['forecastDays'][0]['sun']['rise'];
              var sunset = data['gweather']['forecastDays'][0]['sun']['set'];

              var date ="";
              // var weather ="";
              // var low_tem = 0;
              // var high_tem = 0;
              var humidity = 0;

              // console.log("=============================================");
              // console.log('local : ' + local);
              // console.log('sunrise : ' + sunrise);
              // console.log('sunset : ' + sunset);
              // console.log("=============================================");

              for(var j = 0 ; j < 10 ; j++){

                var date_weather = new Object();

                date = data['gweather']['forecastDays'][0]['forecast'][j]['time'];
                weather = data['gweather']['forecastDays'][0]['forecast'][j]['sky']['code'];
                low_tem = data['gweather']['forecastDays'][0]['forecast'][j]['temperature']['tmin'];
                high_tem = data['gweather']['forecastDays'][0]['forecast'][j]['temperature']['tmax'];
                humidity = data['gweather']['forecastDays'][0]['forecast'][j]['humidity'];


                // console.log("date : " + date);
                // console.log("weather : " + cloud_status[weather]);
                // console.log("low_tem : " + Math.round(low_tem));
                // console.log("high_tem : " + Math.round(high_tem));
                // console.log("humidity : " + Math.round(humidity));
                // console.log("-------------------------");

                //정보담을 배열 생성 및 추가


                date_weather.date = date;
                date_weather.local = local;
                date_weather.sunrise = sunrise;
                date_weather.sunset = sunset;
                date_weather.humidity = humidity;


                local_weather.push(date_weather);

              } //for end

              weathers[local] = local_weather;
              // console.log("forecast : "+data['gweather']['forecastDays'][0]['forecast'].length);

            }

          });  //ajax end

        } //for end

      }


      function getLocalWeather(){
        var local_weathers = [];


        for(var location_name in locations){
          // console.log(location_name);

          $.ajax({

            type: 'GET' ,
            headers : {
              "appKey" : "06110e9f-0792-32ee-9cb9-6b1bba593ab6",
            },
            url: 'http://apis.skplanetx.com/weather/forecast/6days?version=1&lat='+ locations[location_name].lat +'&lon='+ locations[location_name].lon +'&foretxt=N' ,
            // url: 'http://apis.skplanetx.com/weather/forecast/6days?version=1&lat='+ 37.42 +'&lon='+ 127.52 +'&foretxt=N' ,
            dataType : 'json' ,
            async:false,  //동기 처리를 하기위함 - 비동기처리로 인해 location_name을 가져오는데 문제가생겼기때문
            success: function(data) {
              // console.log(data);

              var local = location_name;
              var elocal = locations[location_name].elocal;

              var local_weather = new Object();


              var date = data['weather']['forecast6days'][0]['timeRelease'].split(' ');  //2017-6-12 18:00:00 형식으로 생김
              var date_arr = date[0].split('-');
              var new_date = new Date( date_arr[0],date_arr[1],date_arr[2] );
              new_date.setDate(new_date.getDate() + 1); //오늘이 8월1일이면  예보시작이 8월 3일임 (이틀 후)

              var weather_am_code ="";
              var weather_pm_code ="";
              var weather_am ="";
              var weather_pm ="";
              var low_tem = 0;
              var high_tem = 0;

              local_weather.local = local;
              local_weather.elocal = elocal;
              var day_local_weathers = [];

              for(var j = 2 ; j < 11 ; j++){ //2일 부터 10일까지 있음

                var day_local_weather = new Object();
                //날짜 연산
                new_date.setDate(new_date.getDate() + 1);
                // var date_weather = new Object();

                weather_am_code = data['weather']['forecast6days'][0]['sky']['amCode'+j+'day'];
                weather_am = data['weather']['forecast6days'][0]['sky']['amName'+j+'day'];
                weather_pm_code = data['weather']['forecast6days'][0]['sky']['pmCode'+j+'day'];
                weather_pm = data['weather']['forecast6days'][0]['sky']['pmName'+j+'day'];

                high_tem = data['weather']['forecast6days'][0]['temperature']['tmax'+j+'day'];
                low_tem = data['weather']['forecast6days'][0]['temperature']['tmin'+j+'day'];

                day_local_weather.date = new_date.getFullYear() + "/" + new_date.getMonth() + "/" + new_date.getDate();
                day_local_weather.weather_am = weather_am_code;
                day_local_weather.weather_pm = weather_pm_code;
                day_local_weather.low_tem = low_tem;
                day_local_weather.high_tem = high_tem;

                day_local_weathers.push(day_local_weather);
                // console.log("date : " + new_date.getFullYear() + "/" + new_date.getMonth() + "/" + new_date.getDate() );
                // console.log("weather_am : " + weather_am + "/" + weather_am_code);
                // console.log("weather_pm : " + weather_pm + "/" + weather_pm_code);
                // console.log("low_tem : " + low_tem);
                // console.log("high_tem : " + high_tem);
                // console.log("-------------------------");

              } //for end

              local_weather.weahter = day_local_weathers;
              local_weathers.push(local_weather);
              // console.log("=============================================");

            } //success end

          });  //ajax end

        } //for end


        console.log(local_weathers);

        setLocalWeather(local_weathers);

      }

      function setLocalWeather(local_weathers){

        for(var index in local_weathers){




        }

      }


      // getWorldWeather();
      getLocalWeather();


    </script>

  </head>
  <body>


    <div class="weather">

    </div>

    <!-- Trigger the modal with a button -->
<button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#weather">지역 선택</button>

<!-- Modal -->
<div id="weather" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Modal Header</h4>
      </div>
      <div class="modal-body">

        <div class="weather_map">

          <div id="map_marker">

            <dl class="marker incheon">
              <dt>인천</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker seoul">
              <dt>서울</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker chuncheon">
              <dt>춘천</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker gangneung">
              <dt>강릉</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker suwon">
              <dt>수원</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker seosan">
              <dt>서산</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker cheongju">
              <dt>청주</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker andong">
              <dt>안동</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker daejeon">
              <dt>대전</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker jeonju">
              <dt>전주</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker daegu">
              <dt>대구</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker pohang">
              <dt>포항</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker ulsan">
              <dt>울산</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker mokpo">
              <dt>목포</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker gwangju">
              <dt>광주</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker yeosu">
              <dt>여수</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker changwon">
              <dt>창원</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker busan">
              <dt>부산</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker ulleung">
              <dt>울릉도</dt>
              <dd class="weather_img"></dd>
            </dl>
            <dl class="marker jeju">
              <dt>제주도</dt>
              <dd class="weather_img"></dd>
            </dl>


          </div>
          <img id="korea_map" src="./img/korea_map2.png" alt=""></img>

        </div>
        <div class="weather_info">
          정보
        </div>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


  </body>
</html>
